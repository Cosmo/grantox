<div>
  <div class="btn-group" role="group">
    <% Grantox::ContentBlock.installed_models.each do |model_name| %>
      <%= link_to model_name.display_name, content_blocks_path(model_name: model_name), class: "btn btn-default #{model_name.to_s == params[:model_name] ? "active" : ""}" %>
    <% end %>
  </div>
</div>

<% if @content_blocks.present? && params[:style] == "box" %>
  <% @content_blocks.in_groups_of(3, false).each do |grouped_content_blocks| %>
    <div class="row">
      <% grouped_content_blocks.each do |content_block| %>
      
        <div class="col-sm-4">
          <div class="thumbnail">
            <div class="caption">
              <span class="label label-default"><%= content_block.class.display_name %></span>
              <h3>
                <%= content_block.name %>
                <small>
                  <%= content_block.version %>
                </small>
              </h3>
              <p>
                <strong>
                  Used in:
                </strong>
                <%= content_block.connectors.map { |c| link_to c.page.name, c.page.path }.join(", ").html_safe %>
              </p>
              <p>
                <%= link_to "Edit", edit_content_block_path(content_block), class: "btn btn-primary" %>
                <%= link_to "Delete", content_block_path(content_block), method: "delete", class: "btn btn-danger" %>
              </p>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  <% end %>
<% elsif @content_blocks.present? %>
  <%= paginate @content_blocks, :theme => 'twitter-bootstrap-3' %>
  
  <table class="table table-striped table-bordered table-hover">
    <tr>
      <th>
        Name
      </th>
      <th>
        Version
      </th>
      <th>
        Usage
      </th>
      <th>
        Actions
      </th>
    </tr>
    <% @content_blocks.each do |content_block| %>
      <tr>
        <td>
          <%= link_to content_block.name || "No Name", edit_content_block_path(content_block) %>
        </td>
        <td>
          <%= content_block.version %>
        </td>
        <td>
          <%= content_block.connectors.map { |c| link_to c.page.name, c.page.path }.join(", ").html_safe %>
        </td>
        <td>
          <%= link_to "Edit", edit_content_block_path(content_block), class: "btn btn-primary btn-xs" %>
          <%= link_to "Delete", content_block_path(content_block), method: "delete", class: "btn btn-danger btn-xs" %>
        </td>
      </tr>
    <% end %>
  </table>
  
  <%= paginate @content_blocks, :theme => 'twitter-bootstrap-3' %>
<% else %>
  <p>
    Keine
  </p>
<% end %>